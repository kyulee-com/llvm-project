# RUN: llc -mtriple=arm64-applie-ios7.0 -homogeneous-prolog-epilog %s -o - | FileCheck %s
#
# This test ensure no outlined epilog is formed when X16 is live across the helper.
--- |
  @FuncPtr = local_unnamed_addr global i32 (i32)* null, align 8

  define i32 @_Z3fooi(i32) minsize "frame-pointer"="all" {
    ret i32 0
  }

  declare i32 @_Z3gooii(i32, i32)
...
---
name:            _Z3fooi
tracksRegLiveness: true
body:             |
  bb.0:
    liveins: $w0

    $w1 = COPY $w0
    $w19 = nsw ADDWri $w0, 1, 0
    ADJCALLSTACKDOWN 0, 0, implicit-def dead $sp, implicit $sp
    $w0 = COPY renamable $w19
    BL @_Z3gooii, csr_aarch64_aapcs, implicit-def dead $lr, implicit $sp, implicit $w0, implicit $w1, implicit-def $sp, implicit-def $w0
    ADJCALLSTACKUP 0, 0, implicit-def dead $sp, implicit $sp
    $x8 = ADRP target-flags(aarch64-page) @FuncPtr
    $x16 = LDRXui killed renamable $x8, target-flags(aarch64-pageoff, aarch64-nc) @FuncPtr
    $w0 = nsw ADDWrr killed renamable $w0, killed renamable $w19
    TCRETURNri killed renamable $x16, 0, csr_aarch64_aapcs, implicit $sp, implicit $w0

# CHECK: _OUTLINED_FUNCTION_PROLOG_FRAME16_x30x29x19x20:
# CHECK-NOT: _OUTLINED_FUNCTION_EPILOG_x30x29x19x20:
